package com.athapong.arcodeapp;

import java.util.ArrayList;
import java.util.List;

import android.database.sqlite.SQLiteDatabase;
import android.os.Bundle;
import android.content.Intent;
import android.util.Log;
import android.view.View;
import android.widget.Button;
import android.widget.ListView;
import android.app.ListActivity;
import com.athapong.arcodeapp.DataBaseHelper;
import com.athapong.arcodeapp.DataBaseHelper.busData;
import com.athapong.arcodeapp.MyAdapter;


public class MylistActivity extends ListActivity {
	
	private ArrayList<String> resultMatchId=new ArrayList<String>();
	private SQLiteDatabase db;
	final DataBaseHelper myDb = new DataBaseHelper(this);
	
	@Override
	protected void onCreate(Bundle savedInstanceState){
		super.onCreate(savedInstanceState);
		setContentView(R.layout.activity_mylist);
		
		// Connect to Database 
  		//myDb.getWritableDatabase();
      	//if(myDb != null){
      	//	Log.d("DB Conect","Database Connected.");
      	//}
      	
      //get Data from MyProcess
      	resultMatchId = getIntent().getStringArrayListExtra("resultMatchId");
      	Log.d("resultMatchId = ", resultMatchId.toString());
		
		// 1. pass context and data to the custom adapter
        MyAdapter adapter = new MyAdapter(this, generateData());
 
        // 2. Get ListView from activity
        ListView myList = (ListView) findViewById(R.id.list);
 
        // 3. setListAdapter
        myList.setAdapter(adapter);
		
      	
		//Button goCapture
				Button btnGoCapture = (Button) findViewById(R.id.capture);
				btnGoCapture.setOnClickListener(new View.OnClickListener() {
							
					@Override
					public void onClick(View v) {
						// TODO Auto-generated method stub
						Intent intent = new Intent(MylistActivity.this,CaptureActivity.class);
						startActivity(intent);
					}
				});
	}
	
	private ArrayList<Item> generateData(){
		ArrayList<Item> items = new ArrayList<Item>();
			for(int i = 0;i<resultMatchId.size();i++){
				Log.d("getId",resultMatchId.get(i));
				int getId = Integer.parseInt(resultMatchId.get(i));
				 List<busData> selectBusData = myDb.selectBusById(getId);
				 items.add((Item) selectBusData);
			}
			return items;
      	}
	

}
